var game=angular.module("game",[]);game.directive("gameBoard",function(){return{restrict:"E",scope:!1,templateUrl:"templates/gameBoard.html"}}).directive("notifications",function(){return{restrict:"E",scope:!1,templateUrl:"templates/notifications.html"}}).directive("instructions",function(){return{restrict:"E",scope:!1,templateUrl:"templates/instructions.html",link:function(e,t,s,i){var o=$(t[0]).children(".collapsible");o.collapsible({accordion:!1})}}}),game.controller("MainCtrl",["$scope","GameState",function(e,t){e.mark=function(s){var i=s.currentTarget,o=parseInt(i.getAttribute("index"),10);try{var n=t.markBox(o);e.boxIconClass[o]="o"==e.currentPlayer?"mdi-image-panorama-fisheye":"mdi-navigation-close",angular.element(i).removeClass("deep-orange").addClass("blue"),n?e.notifications.oneWinner="display:block":$.inArray(0,e.currentState)===-1&&(e.notifications.noWinner="display:block"),e.currentPlayer=t.getCurrentPlayer()}catch(e){toast(e,2e3)}},e.init=function(){e.notifications={oneWinner:"display:none",noWinner:"display:none"};var s=document.querySelectorAll(".box");for(i=0;i<s.length;++i)angular.element(s[i]).removeClass("blue").addClass("deep-orange");e.boxIconClass=["mdi-content-create","mdi-content-create","mdi-content-create","mdi-content-create","mdi-content-create","mdi-content-create","mdi-content-create","mdi-content-create","mdi-content-create"],t.clearGame(),e.currentPlayer=t.getCurrentPlayer(),e.currentState=t.getState()},e.init()}]),game.service("GameState",["$http",function(e){this.boxes=[0,0,0,0,0,0,0,0,0],this.currentPlayer="o",this.getCurrentPlayer=function(){return this.currentPlayer},this.getState=function(){return this.boxes},this.markBox=function(e){if(piece=this.currentPlayer,0===this.boxes[e])return this.boxes[e]=piece,!!this.hasWon(piece)||(this.currentPlayer="o"===this.currentPlayer?"x":"o",!1);throw"The box is already checked."},this.hasWon=function(e){return this.boxes[0]===e&&this.boxes[0]===this.boxes[1]&&this.boxes[1]===this.boxes[2]||this.boxes[3]===e&&this.boxes[3]===this.boxes[4]&&this.boxes[4]===this.boxes[5]||this.boxes[6]===e&&this.boxes[6]===this.boxes[7]&&this.boxes[7]===this.boxes[8]||this.boxes[2]===e&&this.boxes[2]===this.boxes[4]&&this.boxes[4]===this.boxes[6]||this.boxes[0]===e&&this.boxes[0]===this.boxes[4]&&this.boxes[4]===this.boxes[8]||this.boxes[0]===e&&this.boxes[0]===this.boxes[3]&&this.boxes[3]===this.boxes[6]||this.boxes[1]===e&&this.boxes[1]===this.boxes[4]&&this.boxes[4]===this.boxes[7]||this.boxes[2]===e&&this.boxes[2]===this.boxes[5]&&this.boxes[5]===this.boxes[8]},this.clearGame=function(){this.boxes=[0,0,0,0,0,0,0,0,0],this.currentPlayer="o"}}]);